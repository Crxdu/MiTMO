# Исследование  факторов  и организация работы с таблицами данных 

Набор данных: data_purch.xlsx.

Статистика о государственных закупках лекарственных препаратов в 2021 году согласно Единой информационной системе в сфере закупок.
Информация  об  одной  процедуре  может  занимать  более  одной  строки.  
Если    в    рамках    процедуры    производилась    закупка    только    одного лекарственного препарата, 
то такая процедура в таблице будет встречаться один раз и занимать одну строку. 
Если в одной процедуре содержалось n закупочных  позиций,  то  информация  об  этой  процедуре  будет  занимать  в таблице n строк.

#### Загрузка данных

*Часть фрейма*

![image](https://user-images.githubusercontent.com/91901972/228652409-68749942-a7fe-4ca6-adae-17c55e70ab59.png)

######  Описание данных

* first_pub_date – дата публикации процедуры
* final_protocol_pub_date – дата завершения процедуры
* purchase_number – идентификатор процедуры
* collecting_start_date – дата начала сбора заявок от потенциальных поставщиков
* collecting_end_date – дата окончания сбора заявок от потенциальных поставщиков
* placing_base_name – форма проведения торгов (конкурс, аукцион и т.п.)
* cust_reg – регион заказчика процедуры
* lot_price_correct – максимально возможная, объявленная заказчиком, цена за все препараты в закупке
* drug_mnn_ext_code – идентификатор лекарственного препарата
* drug_mnn_name – наименование лекарственного препарата (их меньше, чем drug_mnn_ext_code)
* drug_qty – объем закупаемого лекарственного препарата
* drug_price – цена за единицу объема закупаемого лекарственного препарата
* drug_position_price – цена за всю позицию закупаемого лекарственного препарата
* ftg – класс закупаемого лекарственного препарата
* is_abnd – фиктивная переменная: 1 – закупка не состоялась, 0 – состоялась
* is_znvlp – фиктивная переменная: 1 – в закупке содержится хотя бы 1 препарат из списка ЖВЛП, 0 – не содержатся
* is_narcotic – фиктивная переменная: 1 – в закупке содержится хотя бы 1 препарат, в составе которого есть наркотические вещества, 0 – не содержатся
* is_msp_purchase – фиктивная переменная: 1 – закупка предназначена только для субъектов малого и среднего предпринимательства, 0 – не предназначена
* is_povt – фиктивная переменная: 1 – эту процедуру заказчик вынужден повторить, 0 – не повторная
* is_dif – фиктивная переменная: 1 – в закупке содержится хотя бы 1 препарат, являющийся дефицитным, 0 – не содержатся
* app_amount_absolute_correct – сумма залога
* advance_sum_correct – сумма аванса

Я считаю, что наибольшее влияние на вероятность незакрытия закупки оказывают следующие факторы:

Lot_price_correct - максимально возможная, объявленная заказчиком, цена за все препараты в закупке. Чем выше цена, тем меньше вероятность того, 
что найдется поставщик, готовый выполнить заказ по данной цене.

Collecting_end_date - дата окончания сбора заявок от потенциальных поставщиков. Если заказчик не смог привлечь достаточное количество поставщиков, 
то это может привести к незакрытию закупки.

Is_abnd - фиктивная переменная, которая указывает, состоялась ли закупка или нет. Если закупка не состоялась в прошлый раз, 
то это может повлиять на вероятность незакрытия закупки в будущем.

Is_povt - фиктивная переменная, которая указывает, повторная ли это процедура. Если это повторная процедура, то это может указывать на то, 
что заказчик не смог найти поставщика в первый раз, что может повлиять на вероятность незакрытия закупки.

#### Группировка
![image](https://user-images.githubusercontent.com/91901972/228652146-768fade1-ad37-407f-a6aa-a2e2a922475a.png)

*часть сгруппированного фрейма*

![image](https://user-images.githubusercontent.com/91901972/228652811-c1a1e35d-2acf-46d8-8822-61b730e2cb5a.png)


#### Формирование факторов
###### Фактор, полученный с помощью метода главных компонент:

Фактор `new_feature` - это фактор, полученный с помощью метода главных компонент из исходных столбцов с информацией о покупках. 
Этот фактор является линейной комбинацией исходных факторов, которые наилучшим образом объясняют вариацию в данных.

###### Факторы, полученные с помощью замен и арифметических операций:

Фактор `avg_lot_price_per_bidder` - Средняя стоимость лота на участника закупки. 
Более высокая стоимость лота на участника может сигнализировать о более крупных и надежных поставщиках

Фактор `total_drug_cost` - это фактор, который представляет суммарную стоимость всех препаратов в этой покупке.
Он вычисляется как произведение стоимости одной единицы препарата на количество препаратов, приобретенных в этой покупке.

#### Разделяем на обучающую и тестовую выборки

при этом целевая переменная будет *is_abnd*

![image](https://user-images.githubusercontent.com/91901972/228653117-ab7ae27b-7635-45b6-b042-1ec69b156b35.png)

#### Оценка  важности  выделенных  факторов  на  основе  метода "Случайного леса" 

![image](https://user-images.githubusercontent.com/91901972/228653491-0637df21-9951-4e4c-8c8f-f02921acb196.png)

![image](https://user-images.githubusercontent.com/91901972/228653542-49883c0a-0f3b-443d-ad05-69fb01291611.png)

![image](https://user-images.githubusercontent.com/91901972/228653613-3dc13f67-13f5-4ccd-bace-83870d4b38c3.png)

#### Построение модели логистической регрессии

Точность модели на обучающей выборке: 0.5055

Точность модели на тестовой выборке: 0.5028

Данные результаты говорят о том, что точность модели на тестовой выборке не сильно отличается от точности на обучающей выборке. 
Однако, точность модели на обеих выборках достаточно низкая (50.55% на обучающей выборке и 50.28% на тестовой выборке), 
что может указывать на то, что модель не обладает высокой способностью к обобщению на новые данные. 
 
 
 






